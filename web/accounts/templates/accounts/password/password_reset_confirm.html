{# templates/accounts/password/password_reset_confirm.html #}
{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Setează parola nouă – Snobistic{% endblock %}

{% block header %}{% endblock %}
{% block footer %}{% endblock %}

{% block content %}
<section class="flat-spacing min-vh-100 d-flex align-items-center py-0" data-aos="fade-up">
  <div class="container">

    {# Logo #}
    <div class="container text-center my-4 pb-5">
      <a href="{% url 'core:home' %}">
        <img src="{% static 'images/logo/logo.png' %}" alt="Snobistic" style="height:56px;width:auto;">
      </a>
    </div>

    <div class="login-wrap">

      {# ==== Col stânga: confirm reset ==== #}
      <div class="left">
        {% if validlink %}
          <div class="heading">
            <h4>Setează o parolă nouă</h4>
            <p class="text-secondary small mt-1 mb-0">
              Alege o parolă nouă pentru contul tău Snobistic.
            </p>
          </div>

          {# Mesaje Django (dacă există) #}
          {% if messages %}
            <div class="mt-3 mb-2" role="status" aria-live="polite">
              {% for m in messages %}
                <div class="alert alert-{{ m.tags|default:'info' }} mb-1">
                  {{ m }}
                </div>
              {% endfor %}
            </div>
          {% endif %}

          <form method="post" class="form-login mt-3" novalidate autocomplete="off">
            {% csrf_token %}

            {# Honeypot anti-bot #}
            <div style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;">
              <label>Lasă acest câmp gol</label>
              <input type="text" name="website" tabindex="-1" autocomplete="off">
            </div>

            <div class="wrap">
              {% if form.non_field_errors %}
                <div class="alert alert-danger mb-3">
                  {{ form.non_field_errors }}
                </div>
              {% endif %}

              {# Django PasswordResetConfirmForm: new_password1/new_password2 #}
              {{ form|crispy }}
            </div>

            <p class="text-secondary small mt-2 mb-3">
              Evită parolele pe care le folosești în alte conturi și combină litere, cifre și simboluri.
            </p>

            <button class="tf-btn btn-fill w-100" type="submit">
              <span class="text text-button">Salvează parola</span>
            </button>
          </form>

        {% else %}
          <div class="heading">
            <h4>Link de resetare invalid</h4>
            <p class="text-secondary small mt-1 mb-0">
              Linkul de resetare nu este valid sau a expirat.
            </p>
          </div>

          {# Mesaje Django (dacă există) #}
          {% if messages %}
            <div class="mt-3 mb-2" role="status" aria-live="polite">
              {% for m in messages %}
                <div class="alert alert-{{ m.tags|default:'info' }} mb-1">
                  {{ m }}
                </div>
              {% endfor %}
            </div>
          {% endif %}

          <div class="wrap mt-3">
            <div class="alert alert-danger mb-3">
              Linkul de resetare nu este valid sau a expirat.
            </div>

            <a href="{% url 'accounts:password_reset' %}" class="tf-btn btn-fill w-100">
              <span class="text text-button">Cere un nou link de resetare</span>
            </a>
          </div>
        {% endif %}

        <div class="text-center mt-3">
          <a href="{% url 'accounts:login' %}" class="text-button link">
            &larr; Înapoi la autentificare
          </a>
        </div>
      </div>

      {# ==== Col dreapta: securitate ==== #}
      <div class="right d-none d-lg-block">
        <h4 class="mb_8">Sfat de securitate</h4>
        <p class="text-secondary">
          Nu folosi parole ușor de ghicit (gen <em>parola123</em>) și nu le nota în locuri accesibile altor persoane.
          Un manager de parole te poate ajuta să le păstrezi în siguranță.
        </p>
        <p class="text-secondary small mb-0">
          Recomandare: minim 12 caractere și o combinație de litere mari/mici, cifre și simboluri.
        </p>
      </div>

    </div>
  </div>
</section>
{% endblock %}
