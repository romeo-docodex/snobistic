{% extends "base.html" %}
{% load static %}
{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'core:home' %}">Home</a></li>
    <li class="breadcrumb-item"><a href="{% url 'products:product_list' %}">Catalog</a></li>
    {% if product.category %}<li class="breadcrumb-item">{{ product.category.name }}</li>{% endif %}
    <li class="breadcrumb-item active">{{ product.name }}</li>
  </ol>
</nav>

<div class="row">
  <div class="col-md-6">
    {% if product.images.exists %}
      <div id="carouselProd" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          {% for img in product.images.all %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <img src="{{ img.image.url }}" class="d-block w-100" alt="{{ img.alt_text }}">
            </div>
          {% endfor %}
        </div>
        <button class="carousel-control-prev" data-bs-target="#carouselProd" data-bs-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" data-bs-target="#carouselProd" data-bs-slide="next">
          <span class="carousel-control-next-icon"></span>
        </button>
      </div>
    {% endif %}
    {% if product.authenticity_proof %}
      <p class="mt-2"><a href="{{ product.authenticity_proof.url }}" target="_blank">Descarcă certificatul de autenticitate</a></p>
    {% endif %}
  </div>
  <div class="col-md-6">
    <h2>{{ product.name }}</h2>
    <p class="h4 text-primary">{{ product.price }} EUR</p>
    <p><strong>Stare:</strong> {{ product.get_condition_display }}</p>
    <p><strong>Brand:</strong> {{ product.brand.name if product.brand }}</p>
    <p>{{ product.description|linebreaks }}</p>

    <div class="d-grid gap-2">
      {% if user.is_authenticated %}
        <a href="{% url 'cart:add_to_cart' product.id %}" class="btn btn-success">Adaugă în coș</a>
        <a href="{% url 'shop:add_to_favorites' product.id %}" class="btn btn-outline-secondary">Favorite ❤️</a>
      {% else %}
        <a href="{% url 'accounts:login' %}?next={{ request.path }}" class="btn btn-success">Autentifică-te ca să cumperi</a>
      {% endif %}
      <form method="post" action="{% url 'products:report_product' product.id %}">
        {% csrf_token %}
        <textarea name="reason" class="form-control mb-2" placeholder="Motiv raport (opțional)"></textarea>
        <button class="btn btn-warning">Raportează produs</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
